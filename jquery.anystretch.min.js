/*
 * jQuery Anystretch
 * Version 1.2 (@jbrooksuk / me.itslimetime.com)
 * https://github.com/jbrooksuk/jquery-anystretch
 * Based on Dan Millar's Port
 * https://github.com/danmillar/jquery-anystretch
 *
 * Add a dynamically-resized background image to the body
 * of a page or any other block level element within it
 *
 * Copyright (c) 2012 Dan Millar (@danmillar / decode.uk.com)
 * Dual licensed under the MIT and GPL licenses.
 *
 * This is a fork of jQuery Backstretch (v1.2)
 * Copyright (c) 2011 Scott Robbin (srobbin.com)
*/
!function(e){e.fn.anystretch=function(t,n,i){var a=this.selector.length?!1:!0;return this.each(function(o){function s(){if(t||m.length>=1){var n;w.screenSizes=[],a||m.css({position:w.elPosition,background:"none"}),0==v.length?v=e("<div />").attr("class","anystretch").css({left:0,top:0,position:a?"fixed":"absolute",overflow:"hidden",zIndex:a?-999999:-999998,margin:0,padding:0,height:"100%",width:"100%"}):v.find("img").addClass("deleteable"),n=e("<img />").css({position:"absolute",display:"none",margin:0,padding:0,border:"none",zIndex:-999999}).bind("load",function(t){var n,a,o=e(this);o.css({width:"auto",height:"auto"}),n=this.width||e(t.target).width(),a=this.height||e(t.target).height(),h=n/a,r(function(){o.fadeIn(w.speed,function(){v.find(".deleteable").remove(),"function"==typeof i&&i()})})}).appendTo(v),0==m.children(".anystretch").length&&(a?e("body").append(v):m.append(v)),v.data("settings",w);var o="";if(t?o=t:m.data(w.dataName)&&(o=m.data(w.dataName)),m.data(w.responsiveDataName))for(var s=m.data(w.responsiveDataName).split(","),d=e(window).width(),c=0;c<s.length;c++){var p=s[c].split(" ").filter(function(e){return""!==e});w.screenSizes.push([parseInt(p[1].replace("w","")),p[0]]),d>parseInt(p[1].replace("w",""))&&(o=p[0])}if(m.data(w.nonbgDataName)&&(v.parent().css({position:"relative",overflow:"hidden"}),v.addClass("nonbg").css({zIndex:1,position:"relative"}),n.css({zIndex:1,position:"relative"})),!o)return;e(window).resize(r),n.attr("src",o)}}function r(t){try{if(g={left:0,top:0},p=d(),l=p/h,l>=c()?(f=(l-c())/2,"center"==w.positionY||w.centeredY?e.extend(g,{top:"-"+f+"px"}):"bottom"==w.positionY&&e.extend(g,{top:"auto",bottom:"0px"})):(l=c(),p=l*h,f=(p-d())/2,"center"==w.positionX||w.centeredX?e.extend(g,{left:"-"+f+"px"}):"right"==w.positionX&&e.extend(g,{left:"auto",right:"0px"})),m.data(w.responsiveDataName))for(var n=0;n<w.screenSizes.length;n++)if(e(window).width()>w.screenSizes[n][0]){imgSrc=w.screenSizes[n][1];break}v.children("img:not(.deleteable)").width(p).height(l).filter("img").css(g),imgSrc&&v.children("img:not(.deleteable)").filter("img").attr("src",w.screenSizes[n][1])}catch(i){}"function"==typeof t&&t()}function d(){return a?m.width():m.innerWidth()}function c(){return a?m.height():m.innerHeight()}var h,p,l,f,g,u={positionX:"center",positionY:"center",speed:0,elPosition:"relative",dataName:"stretch",responsiveDataName:"stretch-responsive",nonbgDataName:"stretch-nonbg"},m=e(this),v=a?e(".anystretch"):m.children(".anystretch"),w=v.data("settings")||u;v.data("settings");return n&&"object"==typeof n&&e.extend(w,n),n&&"function"==typeof n&&(i=n),e(document).ready(s),this})},e.anystretch=function(t,n,i){var a=e("onorientationchange"in window?document:window);a.anystretch(t,n,i)}}(jQuery);